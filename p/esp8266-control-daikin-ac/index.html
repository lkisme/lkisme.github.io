
<!DOCTYPE html>
<html lang="zh-cn,en,default">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="种豆南山下">
    <title>大金空调面板Hack添加WiFi支持 - 种豆南山下</title>
    <meta name="author" content="KK">
    
        <meta name="keywords" content="hexo,java,智能家居,">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"KK","sameAs":["https://github.com/lkisme","http://stackoverflow.com/users/2481485","https://twitter.com/","https://facebook.com/lkkme","https://plus.google.com/","https://www.linkedin.com/in/liukk","mailto:lkisme@me.com"],"image":"avatar.webp"},"articleBody":"背景装修时家里装了大金的1拖2中央空调，当时可以选“金制家中”的套餐，只要加1000块，结果脑抽没选。入住之后马上感觉到不爽的地方：\n\n无法远程控制：夏天下班回家后，家里还是很热，立马开空调也要过几分钟才会凉下来，冬天同理。\n无法远程控制：冬天要起床开关空调，\n其他扩展功能：定时关定时开只能在面板上选择，且只能以半小时为单位。\n指示灯的问题：晚上睡觉指示灯一直亮着，烦人\n\n\n\n可选方案首先是想买一套金制家中，大概就是一个Wi-Fi网关+几个传感器，这个主要问题是要装在外机上（大误），于是放弃了，继续搜索可以接入米家控制的设备，大概有三种：\n\n大金官方的方案：WiFi控制器（金制家中）\nvrf面板，价格在300-600之间，要替换掉自带面板，特点是安装简单，且可以卖掉原版的线控，回一波血\n线控网关，原理和#1一样，接在空调内机的P1&#x2F;P2上，价格在300-400之间。安装比较麻烦\n集控网关，原理和金制家中一样，接在F1&#x2F;F2上，可以控制所有内机。价格在1000-2000之间，安装难度和#2一样，特点是一台机器可以控制所有内机，如果家里内机较多，可以考虑这个\nDIY：难度较高\n\n原理分析下图是线控网关的安装拓扑\n\n对于大金空调的控制，大概的方式可以分为2种\n\nF1&#x2F;F2单台外机：空调网关的F1&#x2F;F2连接大金中央空调的室内机或者室外机的“F1&#x2F;F2”。多台外机：空调网关的F1&#x2F;F2连接大金中央空调室外机的“F1F2”。\n金制家中应该就是这种方案，此外集控网关也是这种方案，优点是一台机器控制所有空调。\nP1&#x2F;P2基于HBS协议的载波通信。没有太深入的了解，大概就是这两根线既可以提供电源（压差大概15V多一点），又可以载波通信（高20V，低10V）。国内可以买到的很多线控网关都是做了一个HBS的解析器+控制器。网上也有开源的方案，但要自己做硬件，于是放弃。\n所有的线控都是内机-&gt;解码-&gt;控制器-&gt;网关这样的链路。而自带的面板只是缺了「网关」这一环，所以我们可以制作一个可以控制面板的带有网关功能的设备，就可以轻松实现联网控制空调了。\n实操首先我买了一个线控网关，接起来真的费劲，接线图如下所示：\n其原理上边讲了，相当于一个内机接了2个遥控，第二个遥控配上了WiFi网关。\n第二个内机不想再买线控网关了，觉得这看起来功能很简单啊，于是在网上搜相关的方案，搜到了这个：https://lecoding.com/post/2020/daikin-remote-controller-hack/ ，这偏文章里通过红外来控制原始的控制面板，但有以下几个问题：如果需要远程控制，需要再加一个红外网关。而我最近在研究8266，手里拿着锤子看见所有东西都是钉子，于是开始改造。但改造失败，因为接上8266之后面板就会重启，之后会不断的重启，另外由于没有断电操作，把面板上的电源指示灯LED烧了，额外解决了最开始的#4个诉求。。。\n\n改造计划暂时搁置，最近又在英文世界里冲浪，找找老外的解决方案，找到了一个使用Arduino来解决问题的：AIRDUINO | ADDING NETWORK REMOTE CONTROL TO THE DAIKIN VRV WITH THE BRC1D61 OR SIMILAR THERMOSTATS，于是又燃起了改造的激情，这次增加了读取LED状态的接线，这样就能精确控制空调了。接线如下：\n\n电源问题接上之后好了几个小时，面板又重启了，另外一接上8266，就能听到滋滋的声音，应该是面板上15V转5V的变压器受不了额外的载荷，发出了以此抖动的声音。于是不得已，又从相邻的卧室灯开关的接线盒拉出来了220V的线：\n最终方案\n220V接AC-DC电源变3.3V接8266电源，将8266和电源塞进了面板背后的86接线盒内\n面板的GND接8266的GND\n面板的2条引线分别串联20K左右的电阻，接8266的GPIO引脚\nHA配置如下所示\n\n123456789- platform: mqtt  name: &quot;卧室空调&quot;  unique_id: switch.wifi.bedroom_ac  payload_on: &quot;1&quot;  payload_off: &quot;0&quot;  state_topic: daikin/bedroom/state  command_topic: daikin/bedroom/command  availability_topic: daikin/bedroom/availability  json_attributes_topic: daikin/bedroom/attrs\n\n\n家里有一台N1装了HASS+NodeRed+MQTT，自制了一个离线的语音控制器放在卧室，这样就可以开关（灯、暖气、空调、其他）基本靠吼了。\n最终形态\n","dateCreated":"2022-03-29T14:59:12+00:00","dateModified":"2022-04-02T14:05:24+00:00","datePublished":"2022-03-29T14:59:12+00:00","description":"背景装修时家里装了大金的1拖2中央空调，当时可以选“金制家中”的套餐，只要加1000块，结果脑抽没选。入住之后马上感觉到不爽的地方：\n\n无法远程控制：夏天下班回家后，家里还是很热，立马开空调也要过几分钟才会凉下来，冬天同理。\n无法远程控制：冬天要起床开关空调，\n其他扩展功能：定时关定时开只能在面板上选择，且只能以半小时为单位。\n指示灯的问题：晚上睡觉指示灯一直亮着，烦人\n","headline":"大金空调面板Hack添加WiFi支持","image":["https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg","https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"http://lkisme.github.io/p/esp8266-control-daikin-ac/"},"publisher":{"@type":"Organization","name":"KK","sameAs":["https://github.com/lkisme","http://stackoverflow.com/users/2481485","https://twitter.com/","https://facebook.com/lkkme","https://plus.google.com/","https://www.linkedin.com/in/liukk","mailto:lkisme@me.com"],"image":"avatar.webp","logo":{"@type":"ImageObject","url":"avatar.webp"}},"url":"http://lkisme.github.io/p/esp8266-control-daikin-ac/","keywords":"homeassistant 大金 智能家居","thumbnailUrl":"https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg"}</script>
    <meta name="description" content="背景装修时家里装了大金的1拖2中央空调，当时可以选“金制家中”的套餐，只要加1000块，结果脑抽没选。入住之后马上感觉到不爽的地方：  无法远程控制：夏天下班回家后，家里还是很热，立马开空调也要过几分钟才会凉下来，冬天同理。 无法远程控制：冬天要起床开关空调， 其他扩展功能：定时关定时开只能在面板上选择，且只能以半小时为单位。 指示灯的问题：晚上睡觉指示灯一直亮着，烦人">
<meta property="og:type" content="blog">
<meta property="og:title" content="大金空调面板Hack添加WiFi支持">
<meta property="og:url" content="http://lkisme.github.io/p/esp8266-control-daikin-ac/index.html">
<meta property="og:site_name" content="种豆南山下">
<meta property="og:description" content="背景装修时家里装了大金的1拖2中央空调，当时可以选“金制家中”的套餐，只要加1000块，结果脑抽没选。入住之后马上感觉到不爽的地方：  无法远程控制：夏天下班回家后，家里还是很热，立马开空调也要过几分钟才会凉下来，冬天同理。 无法远程控制：冬天要起床开关空调， 其他扩展功能：定时关定时开只能在面板上选择，且只能以半小时为单位。 指示灯的问题：晚上睡觉指示灯一直亮着，烦人">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/144000776-37a099fd-2056-4140-bc03-1bcf7cb4c0b5.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/144000705-39cbc944-6fdf-4b57-98e2-7dacc64d3f5c.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/144000648-b6d5cf7c-6c57-4ea9-88b1-d5709a9bb5c8.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/161364516-fc45bee4-67c9-4025-886c-c05143622af1.JPG">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/144226767-0e6ff656-9adb-4948-8b66-f4ee0aca2bbd.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/144226833-8ad835fd-67be-4d16-a9c5-cabd103a09f9.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/144226809-9030fd06-a16e-4151-8d8b-39529d08844e.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/2712885/160620943-1db84d92-4889-4da0-9465-6e537c43c9e3.jpg">
<meta property="article:published_time" content="2022-03-29T14:59:12.000Z">
<meta property="article:modified_time" content="2022-04-02T14:05:24.832Z">
<meta property="article:author" content="KK">
<meta property="article:tag" content="homeassistant 大金 智能家居">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/2712885/144000776-37a099fd-2056-4140-bc03-1bcf7cb4c0b5.png">
    
    
        
    
    
        <meta property="og:image" content="http://lkisme.github.io/assets/images/avatar.webp"/>
    
    
        <meta property="og:image" content="https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg"/>
    
    
        <meta property="og:image" content="https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg"/>
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-oobsyaqfg3ukzbkqiupzhmtxkvc4kpjqagkzdkhsymniql3wwpv043pzaoxl.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=308719934"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '308719934');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            种豆南山下
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打开链接: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/avatar.webp" alt="作者的图片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="阅读有关作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.webp" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">KK</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="首页"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="分类"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="标签"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="归档"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜索"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜索</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="关于"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/lkisme"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="http://stackoverflow.com/users/2481485"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Stack Overflow"
                        >
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://twitter.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://facebook.com/lkkme"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://plus.google.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Google Plus"
                        >
                        <i class="sidebar-button-icon fab fa-google-plus" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Google Plus</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/liukk"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:lkisme@me.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="邮箱"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">邮箱</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-center
                    post-header-cover--partial"
             style="background-image:url('https://user-images.githubusercontent.com/2712885/161278001-c51e14f9-c5c0-44f2-9dce-0bb5f0f5542b.jpg');"
             data-behavior="5">
            
        </div>

            <div id="main" data-behavior="5"
                 class="hasCover
                        hasCoverMetaOut
                        hasCoverCaption">
                
<article class="post">
    
        <span class="post-header-cover-caption caption">The bund</span>
    
    
        <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            大金空调面板Hack添加WiFi支持
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-03-29T14:59:12+00:00">
	
		    3月 29, 2022
    	
    </time>
    
        <span>发布在 </span>
        
    <a class="category-link" href="/categories/%E6%99%BA%E8%83%BD%E5%AE%B6%E5%B1%85/">智能家居</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>装修时家里装了大金的1拖2中央空调，当时可以选“金制家中”的套餐，只要加1000块，结果脑抽没选。入住之后马上感觉到不爽的地方：</p>
<ol>
<li>无法远程控制：夏天下班回家后，家里还是很热，立马开空调也要过几分钟才会凉下来，冬天同理。</li>
<li>无法远程控制：冬天要起床开关空调，</li>
<li>其他扩展功能：定时关定时开只能在面板上选择，且只能以半小时为单位。</li>
<li>指示灯的问题：晚上睡觉指示灯一直亮着，烦人</li>
</ol>
<span id="more"></span>

<h2 id="可选方案"><a href="#可选方案" class="headerlink" title="可选方案"></a>可选方案</h2><p>首先是想买一套金制家中，大概就是一个Wi-Fi网关+几个传感器，这个主要问题是要装在外机上（大误），于是放弃了，继续搜索可以接入米家控制的设备，大概有三种：</p>
<ol>
<li>大金官方的方案：WiFi控制器（金制家中）</li>
<li>vrf面板，价格在300-600之间，要替换掉自带面板，特点是安装简单，且可以卖掉原版的线控，回一波血</li>
<li>线控网关，原理和#1一样，接在空调内机的P1&#x2F;P2上，价格在300-400之间。安装比较麻烦</li>
<li>集控网关，原理和金制家中一样，接在F1&#x2F;F2上，可以控制所有内机。价格在1000-2000之间，安装难度和#2一样，特点是一台机器可以控制所有内机，如果家里内机较多，可以考虑这个</li>
<li>DIY：难度较高</li>
</ol>
<h2 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h2><p>下图是线控网关的安装拓扑</p>
<img width="645" alt="xiankong" src="https://user-images.githubusercontent.com/2712885/144000776-37a099fd-2056-4140-bc03-1bcf7cb4c0b5.png">
对于大金空调的控制，大概的方式可以分为2种

<h3 id="F1-x2F-F2"><a href="#F1-x2F-F2" class="headerlink" title="F1&#x2F;F2"></a>F1&#x2F;F2</h3><p>单台外机：空调网关的F1&#x2F;F2连接大金中央空调的室内机或者室外机的“F1&#x2F;F2”。<br>多台外机：空调网关的F1&#x2F;F2连接大金中央空调室外机的“F1F2”。</p>
<p>金制家中应该就是这种方案，此外集控网关也是这种方案，优点是一台机器控制所有空调。<br><img src="https://user-images.githubusercontent.com/2712885/144000705-39cbc944-6fdf-4b57-98e2-7dacc64d3f5c.jpg" alt="jikong"></p>
<h3 id="P1-x2F-P2"><a href="#P1-x2F-P2" class="headerlink" title="P1&#x2F;P2"></a>P1&#x2F;P2</h3><p>基于HBS协议的载波通信。没有太深入的了解，大概就是这两根线既可以提供电源（压差大概15V多一点），又可以载波通信（高20V，低10V）。国内可以买到的很多线控网关都是做了一个HBS的解析器+控制器。网上也有开源的方案，但要自己做硬件，于是放弃。<br><img src="https://user-images.githubusercontent.com/2712885/144000648-b6d5cf7c-6c57-4ea9-88b1-d5709a9bb5c8.png" alt="hbs-chip"></p>
<p>所有的线控都是内机-&gt;解码-&gt;控制器-&gt;网关这样的链路。而自带的面板只是缺了「网关」这一环，所以我们可以制作一个可以控制面板的带有网关功能的设备，就可以轻松实现联网控制空调了。</p>
<h2 id="实操"><a href="#实操" class="headerlink" title="实操"></a>实操</h2><p>首先我买了一个线控网关，接起来真的费劲，接线图如下所示：<br><img src="https://user-images.githubusercontent.com/2712885/161364516-fc45bee4-67c9-4025-886c-c05143622af1.JPG" alt="大金控制面板"></p>
<p>其原理上边讲了，相当于一个内机接了2个遥控，第二个遥控配上了WiFi网关。</p>
<p>第二个内机不想再买线控网关了，觉得这看起来功能很简单啊，于是在网上搜相关的方案，搜到了这个：<a target="_blank" rel="noopener" href="https://lecoding.com/post/2020/daikin-remote-controller-hack/">https://lecoding.com/post/2020/daikin-remote-controller-hack/</a> ，这偏文章里通过红外来控制原始的控制面板，但有以下几个问题：如果需要远程控制，需要再加一个红外网关。而我最近在研究8266，手里拿着锤子看见所有东西都是钉子，于是开始改造。但改造失败，因为接上8266之后面板就会重启，之后会不断的重启，另外由于没有断电操作，把面板上的电源指示灯LED烧了，额外解决了最开始的#4个诉求。。。</p>
<p><img src="https://user-images.githubusercontent.com/2712885/144226767-0e6ff656-9adb-4948-8b66-f4ee0aca2bbd.jpg" alt="front_before"></p>
<p>改造计划暂时搁置，最近又在英文世界里冲浪，找找老外的解决方案，找到了一个使用Arduino来解决问题的：<a target="_blank" rel="noopener" href="https://mattala.com.au/2016/08/14/airduino-network-enabling-the-daikin-vrv-with-the-brc1d61-or-similar-thermostats/">AIRDUINO | ADDING NETWORK REMOTE CONTROL TO THE DAIKIN VRV WITH THE BRC1D61 OR SIMILAR THERMOSTATS</a>，于是又燃起了改造的激情，这次增加了读取LED状态的接线，这样就能精确控制空调了。接线如下：<br><img src="https://user-images.githubusercontent.com/2712885/144226833-8ad835fd-67be-4d16-a9c5-cabd103a09f9.jpg" alt="front_done"></p>
<p><img src="https://user-images.githubusercontent.com/2712885/144226809-9030fd06-a16e-4151-8d8b-39529d08844e.jpg" alt="back"></p>
<h3 id="电源问题"><a href="#电源问题" class="headerlink" title="电源问题"></a>电源问题</h3><p>接上之后好了几个小时，面板又重启了，另外一接上8266，就能听到滋滋的声音，应该是面板上15V转5V的变压器受不了额外的载荷，发出了以此抖动的声音。于是不得已，又从相邻的卧室灯开关的接线盒拉出来了220V的线：</p>
<h2 id="最终方案"><a href="#最终方案" class="headerlink" title="最终方案"></a>最终方案</h2><ol>
<li>220V接AC-DC电源变3.3V接8266电源，将8266和电源塞进了面板背后的86接线盒内</li>
<li>面板的GND接8266的GND</li>
<li>面板的2条引线分别串联20K左右的电阻，接8266的GPIO引脚</li>
<li>HA配置如下所示</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- platform: mqtt</span><br><span class="line">  name: &quot;卧室空调&quot;</span><br><span class="line">  unique_id: switch.wifi.bedroom_ac</span><br><span class="line">  payload_on: &quot;1&quot;</span><br><span class="line">  payload_off: &quot;0&quot;</span><br><span class="line">  state_topic: daikin/bedroom/state</span><br><span class="line">  command_topic: daikin/bedroom/command</span><br><span class="line">  availability_topic: daikin/bedroom/availability</span><br><span class="line">  json_attributes_topic: daikin/bedroom/attrs</span><br></pre></td></tr></table></figure>


<p>家里有一台N1装了HASS+NodeRed+MQTT，自制了一个离线的语音控制器放在卧室，这样就可以开关（灯、暖气、空调、其他）基本靠吼了。</p>
<h3 id="最终形态"><a href="#最终形态" class="headerlink" title="最终形态"></a>最终形态</h3><p><img src="https://user-images.githubusercontent.com/2712885/160620943-1db84d92-4889-4da0-9465-6e537c43c9e3.jpg" alt="最终形态"></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/homeassistant-%E5%A4%A7%E9%87%91-%E6%99%BA%E8%83%BD%E5%AE%B6%E5%B1%85/" rel="tag">homeassistant 大金 智能家居</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/p/hass-config/"
                    data-tooltip="Home Assistant控制设备"
                    aria-label="上一篇: Home Assistant控制设备"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                    title="分享到 Facebook"
                    aria-label="分享到 Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                    title="分享到 Google+"
                    aria-label="分享到 Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 KK. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/p/hass-config/"
                    data-tooltip="Home Assistant控制设备"
                    aria-label="上一篇: Home Assistant控制设备"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                    title="分享到 Facebook"
                    aria-label="分享到 Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                    title="分享到 Google+"
                    aria-label="分享到 Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                        aria-label="分享到 Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>分享到 Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                        aria-label="分享到 Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://lkisme.github.io/p/esp8266-control-daikin-ac/"
                        aria-label="分享到 Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>分享到 Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.webp" alt="作者的图片"/>
        
            <h4 id="about-card-name">KK</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-xfar6ak73oauvuksyeord0kjnxscpkqwhbgwjhfmmygs3hnqks2uukexdpg2.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
